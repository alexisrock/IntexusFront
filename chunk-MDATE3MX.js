import{a as x,b as v,c as _,d as I,e as N,f as u,g as F,h as k,i as y,j as Y,k as Z,l as ee,m as M,n as A}from"./chunk-V7L227X3.js";import{a as R}from"./chunk-FXXYGI6V.js";import{a as w}from"./chunk-67DE72J3.js";import{$ as H,C as p,E as c,G as O,H as U,I as j,J as B,K as V,L as i,M as o,N as r,Q as h,R as T,S as P,T as $,U as L,V as Q,W as m,X as z,Y as S,aa as J,ba as K,ha as E,ja as W,k as G,ka as f,v as l,wa as X,x as b,y as C,z as q}from"./chunk-U7YQWJHB.js";var se=["loading"],me=(a,e)=>({"alert-success":a,"alert-danger":e});function ce(a,e){if(a&1&&(i(0,"div",17),m(1),o()),a&2){let t=T();O(H(3,me,t.isCorrect===!0,t.isCorrect===!1)),l(),S(" ",t.message," ")}}function de(a,e){a&1&&(i(0,"div",18),m(1," El nombre de la tarea es obligatorio. "),o())}function pe(a,e){a&1&&(i(0,"div",18),m(1," Introduce un email v\xE1lido. "),o())}var g=class a{constructor(e){this.backService=e;this.loading$=e.loading$,this.backService.loadingOff(),this.miFormulario=new N({tarea:new u("",v.required),descripcion:new u("",[v.required])})}loading$;isCorrect=!1;message="";customLoadingIndicator=null;miFormulario;ShowMessage(e){this.backService.loadingOn(),this.message=e.mensaje,this.isCorrect=e.isCorrect,setTimeout(()=>{this.backService.loadingOff()},6e3)}onSubmit(){if(this.miFormulario.valid){let e={};e.IsCompleted=!1,e.NameTarea=this.miFormulario.get("tarea")?.value,e.DescriptionTarea=this.miFormulario.get("descripcion")?.value,this.backService.CrearTarea(e).subscribe({next:t=>{this.ShowMessage({isCorrect:!0,mensaje:t.message}),this.miFormulario.get("tarea")?.reset(),this.miFormulario.get("descripcion")?.reset()},error:t=>{this.ShowMessage({isCorrect:!1,mensaje:t.message})}})}else this.miFormulario.markAllAsTouched()}static \u0275fac=function(t){return new(t||a)(b(w))};static \u0275cmp=C({type:a,selectors:[["app-create"]],contentQueries:function(t,n,s){if(t&1&&$(s,se,5),t&2){let d;L(d=Q())&&(n.customLoadingIndicator=d.first)}},decls:34,vars:7,consts:[[1,"d-flex"],[1,"p-4"],[1,"fondoTitulos"],[1,"mt-5"],["role","alert",1,"alert",3,"class"],[3,"formGroup"],[1,"row","mt-2"],[1,"col-lg-1","col-md-1","col-ms-1"],[1,"col-lg-10","col-md-10","col-ms-10","border-bottom","border-black"],["id","tarea","type","text","placeholder","Nombre de la tarea","formControlName","tarea",1,"form-control-plaintext","text-dark"],["class","colorRed",4,"ngIf"],["id","descripcion","type","text","placeholder","Descripci\xF3n","formControlName","descripcion",1,"form-control-plaintext","text-dark"],[1,"row","mt-4","p-2"],[1,"col-lg-3","col-md-2","col-ms-2"],[1,"col-lg-7","col-md-8","col-ms-8"],[1,"btn","btn-primary","rounded-pill",3,"click","disabled"],[1,"col-lg-3","col-md-3","col-ms-2"],["role","alert",1,"alert"],[1,"colorRed"]],template:function(t,n){if(t&1&&(i(0,"div",0),r(1,"app-menu"),i(2,"div",1)(3,"div",2)(4,"h2"),m(5,"Crear Tarea"),o()(),r(6,"br")(7,"br"),i(8,"div",3),p(9,ce,2,6,"div",4),J(10,"async"),i(11,"form",5)(12,"div",6),r(13,"div",7),i(14,"div",8),r(15,"input",9),p(16,de,2,0,"div",10),o(),r(17,"div",7),o(),r(18,"br"),i(19,"div",6),r(20,"div",7),i(21,"div",8)(22,"textarea",11),m(23," "),o(),p(24,pe,2,0,"div",10),o(),r(25,"div",7),o(),r(26,"br"),i(27,"div",12),r(28,"div",13),i(29,"div",14)(30,"button",15),h("click",function(){return n.onSubmit()}),m(31,"Enviar"),o()(),r(32,"div",16),o()()()()(),r(33,"app-loadding")),t&2){let s,d;l(9),U(K(10,5,n.loading$)?9:-1),l(2),c("formGroup",n.miFormulario),l(5),c("ngIf",((s=n.miFormulario.get("tarea"))==null?null:s.invalid)&&((s=n.miFormulario.get("tarea"))==null?null:s.touched)),l(8),c("ngIf",((d=n.miFormulario.get("descripcion"))==null?null:d.invalid)&&((d=n.miFormulario.get("descripcion"))==null?null:d.touched)),l(6),c("disabled",n.miFormulario.invalid)}},dependencies:[f,E,W,M,F,x,_,I,k,y,A,R],encapsulation:2})};function ue(a,e){if(a&1&&(i(0,"div",20),m(1),o()),a&2){let t=T();l(),S(" ",t.message," ")}}function fe(a,e){a&1&&(i(0,"div",21),m(1," El nombre de la tarea es obligatorio. "),o())}function ve(a,e){if(a&1&&(i(0,"option",15),m(1),o()),a&2){let t=e.$implicit;P("value",t.Id),l(),z(t.NameUsuario)}}var D=class a{constructor(e){this.backService=e;this.initialComponent()}fg;tareas=[];tarea={};usuarios=[];IsTareaEdit=!1;loading=!1;message="";idTarea;tareaPorAsignarserviceSubscription;tareaIsPorAsignarserviceSubscription;initialComponent(){this.fg=new N({NameTarea:new u("",[v.required]),Usuario:new u(""),DescriptionTarea:new u("")}),this.backService.GetAllusuarios().subscribe({next:e=>{this.usuarios=e.filter(t=>t.Idrol!=3)},error:e=>{}}),this.backService.GetAllTareasAsignadas().subscribe({next:e=>{this.tareas=e},error:e=>{}}),this.tareaIsPorAsignarserviceSubscription=this.backService.currentIsTareaSinAsingnar.subscribe(e=>{this.IsTareaEdit=e}),this.tareaPorAsignarserviceSubscription=this.backService.currentTareaSinAsingnar.subscribe(e=>{e&&(this.fg.patchValue({NameTarea:e.NameTarea||"",DescriptionTarea:e.DescriptionTarea||"",Usuario:""}),this.idTarea=e.Id)})}sendForm(){this.backService.loadingOn(),this.sendTarea();let e=parseInt(this.fg.get("Usuario")?.value);e>0&&(console.log(e),console.log("usuario",e),this.sendAsignacionTarea())}sendTarea(){let e={};e.DescriptionTarea=this.fg.get("DescriptionTarea")?.value,e.NameTarea=this.fg.get("NameTarea")?.value,e.IsCompleted=!1,e.IdTarea=this.idTarea,this.backService.EditarTarea(e).subscribe({next:t=>{this.backService.loadingOff(),this.showMessage(t.message)},error:t=>{this.backService.loadingOff()}})}sendAsignacionTarea(){if(this.idTarea>0){let e={};e.IdTarea=this.idTarea,e.IdUsuario=this.fg.get("Usuario")?.value,this.backService.AsignarTarea(e).subscribe({next:t=>{this.backService.loadingOff(),this.showMessage(t.message)},error:t=>{this.backService.loadingOff()}})}}showMessage(e){this.loading=!0,this.message=e,setTimeout(()=>{this.message="",this.loading=!1},6e3)}static \u0275fac=function(t){return new(t||a)(b(w))};static \u0275cmp=C({type:a,selectors:[["app-asignar-tarea-edit"]],decls:39,vars:3,consts:[[1,"d-flex"],[1,"p-4"],[1,"fondoTitulos"],[1,"mt-5"],[1,"col-lg-7","col-md-8","col-ms-8"],["class","alert alert-success","role","alert",4,"ngIf"],[3,"submit","formGroup"],[1,"row","mt-2"],[1,"col-lg-1","col-md-1","col-ms-1"],[1,"col-lg-10","col-md-10","col-ms-10","border-bottom","border-black"],["type","text","formControlName","NameTarea",1,"form-control-plaintext","text-dark"],["class","colorRed",4,"ngIf"],["formControlName","DescriptionTarea",1,"form-control-plaintext","text-dark"],["formControlName","Usuario","aria-label","Default select example",1,"form-select","form-control-plaintext"],["selected","","value",""],[3,"value"],[1,"row","mt-4","p-2"],[1,"col-lg-3","col-md-2","col-ms-2"],["type","submit","value","Guardar",1,"btn","btn-primary","rounded-pill"],[1,"col-lg-3","col-md-3","col-ms-2"],["role","alert",1,"alert","alert-success"],[1,"colorRed"]],template:function(t,n){if(t&1&&(i(0,"div",0),r(1,"app-menu"),i(2,"div",1)(3,"div",2)(4,"h2"),m(5,"Editar Tareas"),o()(),r(6,"br")(7,"br")(8,"div",3),i(9,"div",4),p(10,ue,2,1,"div",5),o(),i(11,"form",6),h("submit",function(){return n.sendForm()}),i(12,"div",7),r(13,"div",8),i(14,"div",9),r(15,"input",10),o(),p(16,fe,2,0,"div",11),r(17,"div",8),o(),i(18,"div",7),r(19,"div",8),i(20,"div",9),r(21,"textarea",12),o(),r(22,"div",8),o(),r(23,"br"),i(24,"div",7),r(25,"div",8),i(26,"div",9)(27,"select",13)(28,"option",14),m(29,"Seleccione un usuario"),o(),B(30,ve,2,2,"option",15,j),o()(),r(32,"div",8),o(),i(33,"div",16),r(34,"div",17),i(35,"div",4),r(36,"input",18),o(),r(37,"div",19),o()()()(),r(38,"app-loadding")),t&2){let s;l(10),c("ngIf",n.loading),l(),c("formGroup",n.fg),l(5),c("ngIf",((s=n.fg.get("NameTarea"))==null?null:s.invalid)&&((s=n.fg.get("NameTarea"))==null?null:s.touched)),l(14),V(n.usuarios)}},dependencies:[f,E,R,M,F,Z,ee,x,Y,_,I,k,y,A],encapsulation:2})};var ie=[{path:"",component:g},{path:"editarTarea",component:D},{path:"create",component:g}];var re=class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=q({type:a});static \u0275inj=G({imports:[f,X.forChild(ie)]})};export{re as CreateModule};
